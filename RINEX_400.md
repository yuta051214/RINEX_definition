# RINEX 4.00

## 1 RINEX 3.05 から 4.00 への主な変更点

以下のリストは、現行の RINEX フォーマットバージョンと前バージョン（3.05 以前）との間で導入された主な変更点を示しています。ナビゲーションファイルは後方互換性がなくなったため、すべての RINEX ファイルにメジャーバージョン番号が割り当てられています。変更の完全な一覧はセクション 9 にあります。

### ナビゲーションファイル内の変更

- **Table A7**  
  - ヘッダー中の `LEAP SECONDS` 行を必須化（オプション扱いを廃止）  
  - `IONOSPHERIC CORR` 行を削除  
  - `TIME SYSTEM CORR` 行を削除  
  - すべてのナビゲーションメッセージに、新しいレコード先頭行を追加  

- **GPS 用 CNAV メッセージ**  
  - Table A10：GPS CNAV メッセージ定義を追加  
  - Table A11：GPS CNAV-2 メッセージ定義を追加  

- **BDS-3 用メッセージ**  
  - Table A22：BDS-3 B1C メッセージ定義を追加  
  - Table A23：BDS-3 B2a メッセージ定義を追加  
  - Table A24：BDS-3 B2b メッセージ定義を追加  

- **QZSS 用 CNAV メッセージ**  
  - Table A18：QZSS CNAV メッセージ定義を追加  
  - Table A19：QZSS CNAV-2 メッセージ定義を追加  

- **新規メッセージレコード（付録）**  
  - Table A30／A31／A32／A33／A34：STO（時刻オフセット）、EOP（地球回転偏差）、ION（電離層）メッセージのレコード記述を追加  

- **仕様書本文の追加**  
  - セクション 5.4.9：STO（時刻オフセット補正）メッセージの説明を追加  
  - セクション 5.4.10：EOP（地球回転パラメータ）メッセージの説明を追加  
  - セクション 5.4.11：ION（電離層パラメータ）メッセージの説明を追加  

- **ヘッダーの拡張**  
  - Table A7 にオプション行 `REC # / TYPE / VERS` を追加（基準局ナビゲーションファイル向け）  

---

### 観測ファイル内の変更

- **Table A2**  
  - ヘッダー中の `SYS / PHASE SHIFT` 行をオプション化  
- **GLONASS コード・位相整合**  
  - セクション 5.2.16 および Table A2 の `GLONASS COD/PHS/BIS` 行の必須条件を削除  
- **QZSS 新信号 L1 C/B**  
  - Table 14 に観測コード `C1E, L1E, D1E, S1E` を追加  
  - Table A39 において、L1 C/A 非対応時の参照信号として `L1 C/B` を定義  
- **QZSS PRN 割り当て更新**  
  - Table 6 に L1 C/B 用 PRN を追加  


> **QZSS 新信号 L1 C/B について**
>
> - **概要**  
>   - **周波数**：1575.42 MHz（L1帯）  
>   - **変調方式**：BOC(1,1)  
>   - **互換性**：GPS L1C、Galileo E1 OS と互換  
>   - **配信開始**：みちびき6号機（QZS-6）に合わせて2025年7月18日より衛星測位サービスでL1 C/Bを開始
> 
> - **L1 C/A との排他性**  
>   - L1 C/A 信号と L1 C/B 信号は排他的に送信され、同一衛星が同時に両方を放送することはありません
> 
> - **RINEX 4.00 における観測コード**  
>   - `C1E`：擬似距離測定  
>   - `L1E`：搬送波位相測定  
>   - `D1E`：ドップラー（周波数）測定  
>   - `S1E`：信号強度  
>   - これらは仕様書の Table 14 で定義されています
> 
> - **PRN 割り当て**  
>   - RINEX 4.00 の Table 6 に L1 C/B 用 PRN が追加されました  
>   - 例として、みちびき6号機の L1 C/B は PRN 205 に割り当てられています
> 
> - **信号認証サービス対応**  
>   - QZSS の信号認証サービスでは、L1 C/B 信号にも電子署名（信号認証データ）を埋め込んで配信します

---

### 全ファイルでの変更

- **FAIR データ原則対応の自由テキスト行を追加**  
  - `DOI`（Digital Object Identifier）  
  - `LICENSE OF USE`（データ利用ライセンス）  
  - `STATION INFORMATION`（局サイトメタデータへのリンク）  





## 2 RINEX の理念と歴史

受信機非依存交換フォーマット（RINEX: Receiver Independent Exchange Format）の最初の提案は、ベルン大学天文研究所によって行われました。これは、4 つの異なるメーカー製の 60 台以上の GPS 受信機を用いて実施された、最初の大規模な欧州 GPS キャンペーン “EUREF 89” で収集された GPS データを容易に交換するためのものでした。開発にあたって最大の焦点となったのは、以下の事実です。

多くの測地学的 GNSS データ処理ソフトウェアは、以下の限られた一連の観測量のみを使用することを前提としています：

- **搬送波位相観測**  
  衛星から受信した搬送波と受信機内生成基準周波数とのビート周波数を測定したもの  
- **擬似距離（コード）観測**  
  受信時刻（受信機の時系）と送信時刻（衛星の時系）の差として表される  
- **ドップラー観測**  
  受信搬送波周波数と衛星送信周波数との差  
- **信号対雑音比（SNR）観測**  
  キャリア対雑音密度比（C/N₀）または受信信号電力と雑音電力の比  
- **観測時刻**  
  各観測値が有効とされた瞬間における受信機時計の読み  

通常、RINEX ファイル中の観測時刻は、すべての観測値および観測衛星に共通で有効であると仮定されます。そのため、これらのソフトウェアは、受信機が内部的に保持する多くの情報を必要とせず、最小限として「位相」「コード」「時刻」と、局名、アンテナ高、アンテナモデルなどの局情報のみを利用します。

これまでに開発・公開された RINEX の主なメジャーバージョンは以下の通りです：

- **RINEX Version 1** （1989年）  
  第5回国際衛星測位測地シンポジウム（Las Cruces, 1989）で発表・承認  
- **RINEX Version 2** （1990年）  
  第2回精密 GPS 測位シンポジウム（Ottawa, 1990）で発表・承認。GLONASS や SBAS など他 GNSS の追跡データを含める機能を追加  
- **RINEX Version 3** （2000年代初頭）  
  マルチ GNSS をサポートし、各観測の追跡モードを 3 文字コードで明確に識別  
- **RINEX Version 4** （2021年）  
  各衛星のナビゲーションメッセージ、コンステレーション共通パラメータ、グローバルパラメータなどを格納する “データレコード” を定義し、現代のマルチ GNSS ナビゲーションメッセージをサポート  

---

### RINEX Version 2 のサブバージョン

- **2.10**  
  整数秒以外のサンプリングレート許可、生の信号強度を新たな観測量として追加（2002年）  
- **2.11**  
  L2C 擬似距離用の 2 文字観測コード定義、GEO NAV MESS ファイルの一部修正（2005年）※最後の公式版  
- **2.20**  
  IGS LEO パイロットプロジェクトの宇宙機受信機データ交換用の非公式版（2002年）  

2000年代初頭、新たな GNSS コンステレーション（BeiDou、Galileo、QZSS など）や、近代化された GPS/GLONASS の新周波数・観測タイプを効率的に扱うには、RINEX 2 の拡張性が不十分であることが明らかになりました。特に、複数チャネルでの周波数追跡を可能にするため、より柔軟かつ詳細な観測コード定義が求められました。

---

### RINEX Version 3 のサブバージョン

- **3.00**（2007年）  
  マルチ GNSS 観測データを完全にサポート。RINEX 2.20 の宇宙機受信機定義を組み込み  
- **3.01**（2009年）  
  異なる追跡モード間で一貫した位相観測を生成するため、必要に応じて¼周期シフトを適用  
- **3.02**（2013年）  
  QZSS サポート、BeiDou に関する追加情報、GLONASS コード位相バイアス列挙メッセージを追加  
- **3.03**（2015年）  
  NavIC/IRNSS サポートの追加、BeiDou B1 信号規約の修正、GPS/QZSS のフィット間隔フラグ仕様の明確化など  
- **3.04**（2018年）  
  GLONASS、QZSS、BeiDou の信号テーブルに関する補足説明と小規模修正  
- **3.05**（2020年）  
  文書の大規模改訂・再構成、BDS-2/BDS-3 完全サポート、GLONASS ナビメッセージの欠落フラグ・値を追加  

---

### RINEX Version 4 の誕生

2021年、DLR/GSOC（O. Montenbruck 博士ら）を中心とした大規模な取り組みにより、GNSS ナビゲーションメッセージフォーマットの近代化が進められました。各 GNSS ICD を分析し、既存フォーマットで未対応だったメッセージ要素を抽出・定義。各ベンダーの生ナビゲーションデータや内部バイナリフォーマットを解析し、RINEX ワーキンググループのナビゲーションタスクフォースでの議論資料を作成することで、バージョン 4 の大部分が形作られました。全 GNSS コミュニティから高い評価を受けています。





## 3 一般フォーマットの説明

RINEX 4 フォーマットは、以下の 3 種類の ASCII ファイルで構成されています。

1. 観測データファイル（Observation data file）  
2. ナビゲーションメッセージファイル（Navigation message file）  
3. 気象データファイル（Meteorological data file）  

> **電子基準点データ提供サービスで配布されているRINEXファイル（3.02）の各ファイルとの対応**
>
> 観測データファイル（Observation data file）：oファイル
> ナビゲーションメッセージファイル（Navigation message file）：Nファイル
> 気象データファイル（Meteorological data file）：aファイル

---

### ファイル構成

各ファイルは **ヘッダーセクション** と **データセクション** の二つの部分から成ります。

- **ヘッダーセクション**  
  - ファイル全体に関するグローバル情報を含み、ファイル冒頭に配置されます。  
  - 各行の列 61–80 に「ヘッダーラベル」を記述します。これらのラベルは必須で、仕様書や例に示されたとおり厳密に記述しなければなりません。  
  - ヘッダーの長さに上限はなく、多くのラベルは用途に応じて任意です。自由にコメントを追加できます。  

- **データセクション**  
  - 観測データやナビゲーションメッセージ、気象データを記録します。  
  - 可変長レコードを許容するシステムでは、不要な空白を削除して可能な限り短く保つことができます。  
  - 観測レコードに対する最大レコード長の制限はありません。  

---

### フォーマット最適化のポイント

- ヘッダーに「この観測セッションで記録する観測種別」と「観測した衛星システム」を明示することで、受信機や衛星システムごとに観測種別が異なっても、不要な空白を省いて最小限のファイルサイズを実現しています。  

---

### ファイルの利用上の注意

- **観測データファイル** および **気象データファイル** は、基本的に「１局点」「１セッション分」のデータを格納します。  
- 仕様上はヘッダー行をデータセクション中に挿入することも可能ですが、時間が重複しない場合でも複数受信機（またはアンテナ）のデータを同一ファイルに連結することは推奨されません。  
- 複数受信機のデータを交換する必要がある場合は、同じナビゲーションメッセージを何度も繰り返すのは非効率です。  
  - そのため、ある受信機から取得したナビゲーションメッセージファイルを交換するか、または「複数受信機から集めた重複のない情報をまとめた合成ナビゲーションファイル」を作成して利用します。  

---

### 混合ナビゲーションメッセージファイル

RINEX 4 では、異なる衛星システムのナビゲーションメッセージをひとつのファイルに混在させることが想定されており、これによりナビゲーションデータの交換・処理効率が向上します。  

---

### 付録参照

各ファイルタイプのヘッダー・データレコード形式の詳細説明および記述例は、文書末尾のセクション 8（付録表）をご覧ください。  